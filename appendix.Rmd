Appendix: V. Sharma, K. Chen, JL. Etienne
========================================================

# Urban Model
```{r}
df <- read.csv("~/Desktop/STAT202/Final/data/Y2008.csv", header = TRUE, check.names = FALSE)

log.GDP.per.capita <- log(df$`GDP per capita (current US$)`)

urban.population <- df$`Urban population (% of total)`
urban.water <- df$`Improved water source, urban (% of urban population with access)`
```

## Condition Checking
### Linearity checking and transformations
```{r fig.width=7, fig.height=6}
  plot(x = urban.population,
       xlab = "Urban Population (% of Total)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ urban.population)),
         lwd = 3.5,
         col = "firebrick")
```
Size metric appears linear!!



```{r fig.width=7, fig.height=6}
  plot(x = urban.water,
       xlab = "% of Urban Population with Clean Water Access",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ urban.water)),
         lwd = 3.5,
         col = "firebrick")
```
Welfare proxy is not linear! We tried to transform it but nothing would give us anything resembling linearity. We need a new welfare proxy!



```{r fig.width=7, fig.height=6}
urban.sanitation <- df$`Improved sanitation facilities, urban (% of urban population with access)`
  plot(x = urban.sanitation,
       xlab = "% of Urban Population with Sanitation Access",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ urban.sanitation)),
         lwd = 3.5,
         col = "firebrick")
```
We replace access to clean water with access to improved sanitation facilities. We see that log GDP per capita rises with each additional percentage of the urban population that has access to improved sanitation.


### Regression and Exploratory Analysis
```{r}
m <- lm(log.GDP.per.capita ~ urban.sanitation + urban.population)
summary(m)
```
We see significance!

What about equal variance and normality of errors?
```{r fig.width = 7, fig.height = 10}
par(mfrow=c(2,1))
plot(m, which=c(1,2))
```
Yes, there is equal variance! However, there's a long left tail.
We could try non-parametric tests...






# Climate Model
```{r}
emissions.co2.kt <- df$`CO2 emissions (kt)`
emissions.methane <- df$`Methane emissions (kt of CO2 equivalent)`
emissions.nitrous <- df$`Nitrous oxide emissions (thousand metric tons of CO2 equivalent)`
electricity.consumption <- df$`Electric power consumption (kWh per capita)`
paved.roads <- df$`Roads, paved (% of total roads)`

log.emissions.co2.kt <- log(emissions.co2.kt + 0.01)
log.emissions.methane <- log(emissions.methane + 0.01)
log.emissions.nitrous <- log(emissions.nitrous + 0.01)
log.electricity.consumption <- log(electricity.consumption + 0.01)
log.paved.roads <- log(paved.roads + 0.01)
```

## Condition Checking
### Linearity checking and transformations
```{r fig.width = 9, fig.height = 8}
par(mfrow=c(2,3))
  plot(x = emissions.co2.kt,
       xlab = "CO2 Emissions (kt)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ emissions.co2.kt)),
         lwd = 3.5,
         col = "firebrick")

  plot(x = emissions.methane,
       xlab = "Methane Emissions (kt)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ emissions.methane)),
         lwd = 3.5,
         col = "firebrick")


  plot(x = emissions.nitrous,
       xlab = "Nitrous Emissions (kt)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ emissions.nitrous)),
         lwd = 3.5,
         col = "firebrick")

  plot(x = log.emissions.co2.kt,
       xlab = "log CO2 Emissions (kt)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ log.emissions.co2.kt)),
         lwd = 3.5,
         col = "firebrick")

  plot(x = log.emissions.methane,
       xlab = "log Methane Emissions (kt)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ log.emissions.methane)),
         lwd = 3.5,
         col = "firebrick")


  plot(x = log.emissions.nitrous,
       xlab = "log Nitrous Emissions (kt)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ log.emissions.nitrous)),
         lwd = 3.5,
         col = "firebrick")

```
Pollution scatterplots (top row) show no linearity.
Log transformations (bottom row) improve all of them.

```{r fig.width=9, fig.height=8}
par(mfrow=c(2,2))
  plot(x = electricity.consumption,
       xlab = "Electricity Consumption",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ electricity.consumption)),
         lwd = 3.5,
         col = "firebrick")

  plot(x = paved.roads,
       xlab = "Paved Roads (% of total)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ paved.roads)),
         lwd = 3.5,
         col = "firebrick")


  plot(x = log.electricity.consumption,
       xlab = "log Electricity Consumption",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ log.electricity.consumption)),
         lwd = 3.5,
         col = "firebrick")

  plot(x = log.paved.roads,
       xlab = "log Paved Roads (% of total)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ log.paved.roads)),
         lwd = 3.5,
         col = "firebrick")
```
Log transformation improves linearity of electricity consumption, but no so much paved roads, which is already good to begin with.


### Regression and Exploratory Analysis








# Science Model
```{r}
high.tech <- df$`High-technology exports (% of manufactured exports)`
r.n.d <- df$`Research and development expenditure (% of GDP)`
journals <- df$`Scientific and technical journal articles`
log.high.tech <- log(high.tech + 0.01)
log.research <- log(r.n.d + 0.01)
log.journals <- log(journals + 0.01)
```

## Condition Checking
### Linearity checking and transformations
```{r fig.width = 9, fig.height = 8}
par(mfrow=c(2,3))
  plot(x = high.tech,
       xlab = "High-tech exports (% of manufactured exports)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ high.tech)),
         lwd = 3.5,
         col = "firebrick")

  plot(x = r.n.d,
       xlab = "R&D Expenditure (% of GDP)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ r.n.d)),
         lwd = 3.5,
         col = "firebrick")


  plot(x = journals,
       xlab = "Science Journals",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ journals)),
         lwd = 3.5,
         col = "firebrick")

  plot(x = log.high.tech,
       xlab = "log High-tech exports (% of manufactured exports)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ log.high.tech)),
         lwd = 3.5,
         col = "firebrick")

  plot(x = log.research,
       xlab = "log R&D Expenditure (% of GDP)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ log.research)),
         lwd = 3.5,
         col = "firebrick")


  plot(x = log.journals,
       xlab = "log Science Journals",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(summary(lm(log.GDP.per.capita ~ log.journals)),
         lwd = 3.5,
         col = "firebrick")

```
Log-transforming improves linearity of all indicators with respect to log GDP per capita -- although there is still a lot of scatter.

### Regression and Exploratory Analysis














# Social Development Model
```{r}
child.labor <- df$`Children in employment, total (% of children ages 7-14)`
life.expect <- df$`Life expectancy at birth, male (years)`
refugees <- df$`Refugee population by country or territory of origin`
literacy <- df$`Literacy rate, adult total (% of people ages 15 and above)`

log.child.labor <- log(child.labor + 0.01)
log.life.expect <- log(life.expect + 0.01)
log.refugees <- log(refugees + 0.01)
log.literacy <- log(literacy + 0.01)
```

## Condition Checking
### Linearity checking and transformations
```{r fig.width=8, fig.height=6}
par(mfrow=c(2,4))
  
  plot(x = child.labor,
       xlab = "Child Employment (% of chlidren ages 7-14)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(lm(log.GDP.per.capita ~ child.labor),
         lwd = 3.5,
         col = "firebrick")

  plot(x = life.expect,
       xlab = "Life expectancy at birth, male (years)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(lm(log.GDP.per.capita ~ life.expect),
         lwd = 3.5,
         col = "firebrick")

  plot(x = refugees,
       xlab = "Refugee Population",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(lm(log.GDP.per.capita ~ refugees),
         lwd = 3.5,
         col = "firebrick")

  plot(x = literacy,
       xlab = "Literacy Rate (adult total)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(lm(log.GDP.per.capita ~ literacy),
         lwd = 3.5,
         col = "firebrick")




  plot(x = log.child.labor,
       xlab = "log Child Employment (% of chlidren ages 7-14)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(lm(log.GDP.per.capita ~ log.child.labor),
         lwd = 3.5,
         col = "firebrick")

  plot(x = log.life.expect,
       xlab = "log Life expectancy at birth, male (years)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(lm(log.GDP.per.capita ~ log.life.expect),
         lwd = 3.5,
         col = "firebrick")

  plot(x = log.refugees,
       xlab = "log Refugee Population",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(lm(log.GDP.per.capita ~ log.refugees),
         lwd = 3.5,
         col = "firebrick")

  plot(x = log.literacy,
       xlab = "log Literacy Rate (adult total)",
       y = log.GDP.per.capita,
       ylab = "log(GDP per capita)",
       pch = 17, #dot point
       cex = 1.2, #dot size
       col = "darkblue")
  abline(lm(log.GDP.per.capita ~ log.literacy),
         lwd = 3.5,
         col = "firebrick")

```
Discard child labor and literacy rates, as there are not enough data points.

Life expectancy shows linearity with respect to log GDP per capita.

Refugee population's linearity is drastically improved with log transformation.

### Regression and Exploratory Analysis


